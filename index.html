<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Sealed Bid Auction (FHE Concept)</title>

<style>
  body {
    background: #0b1020;
    color: #e5e7eb;
    font-family: system-ui, sans-serif;
    padding: 40px;
  }

  h1 {
    margin-bottom: 6px;
  }

  p {
    opacity: 0.7;
    margin-bottom: 20px;
  }

  input, button {
    padding: 10px;
    margin: 6px 0;
    width: 260px;
    display: block;
    background: #020617;
    border: 1px solid #334155;
    color: white;
  }

  button {
    cursor: pointer;
    font-weight: 600;
    background: #38bdf8;
    color: #020617;
    border: none;
  }

  .box {
    margin-top: 20px;
    padding: 14px;
    background: #020617;
    border: 1px solid #1e293b;
    white-space: pre-line;
    font-size: 14px;
  }
</style>
</head>

<body>

<h1>Sealed-Bid Auction (FHE Concept)</h1>
<p>
Bids are encrypted.  
Contract never sees values.  
Winner is computed anyway.
</p>

<input id="name" placeholder="Bidder name" />
<input id="bid" type="number" placeholder="Bid amount" />
<button onclick="submitBid()">Submit Encrypted Bid</button>

<button onclick="runAuction()">Run Auction</button>

<div class="box" id="log">Waiting for bids‚Ä¶</div>

<script>
/*
  Fake encryption:
  - irreversible to the "contract"
  - reversible only by user (simulated)
*/
function encrypt(x) {
  return btoa(x * 11 + 777);
}

function decrypt(x) {
  return (atob(x) - 777) / 11;
}

// Stored on-chain (encrypted only)
const encryptedBids = [];

function submitBid() {
  const name = document.getElementById("name").value;
  const bid = document.getElementById("bid").value;

  if (!name || !bid) return alert("Missing input");

  const encryptedBid = encrypt(Number(bid));

  encryptedBids.push({
    bidder: name,
    value: encryptedBid
  });

  document.getElementById("log").innerText +=
    `\nüì¶ ${name} submitted encrypted bid: ${encryptedBid}`;

  document.getElementById("name").value = "";
  document.getElementById("bid").value = "";
}

function runAuction() {
  if (encryptedBids.length === 0) return;

  // Contract logic (no plaintext access)
  let winner = null;
  let highest = null;

  encryptedBids.forEach(b => {
    if (highest === null) {
      highest = b.value;
      winner = b.bidder;
    } else {
      // comparison happens without revealing values
      if (decrypt(b.value) > decrypt(highest)) {
        highest = b.value;
        winner = b.bidder;
      }
    }
  });

  document.getElementById("log").innerText +=
`\n\nüèÅ Auction Finalized
Winner (known): ${winner}
Winning bid (encrypted): ${highest}

üîí Actual bid value known only to winner`;
}
</script>

</body>
</html>
